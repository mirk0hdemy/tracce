<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <title>TRACCE</title>
    <!-- Icona del sito -->
    <link rel="icon" type="image/png" href="assets/images/saturn-icon.png">
    <!-- Meta tag per la responsività, essenziale per adattare il contenuto alla larghezza del dispositivo -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Google Material Symbols per le icone e Font Orbit per il testo -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@400&family=Orbit&display=swap" rel="stylesheet" />

    <style>
        /* Stili globali e reset per garantire una base pulita su tutti i browser */
        * {
            -webkit-tap-highlight-color: transparent; /* Rimuove l'evidenziazione al tocco su dispositivi mobili */
            box-sizing: border-box; /* Include padding e border nella larghezza/altezza totale dell'elemento */
        }

        body {
            background-color: black; /* Sfondo nero, come richiesto */
            color: white; /* Colore del testo bianco */
            font-family: 'Orbit', sans-serif; /* Utilizzo del font Orbit */
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centra verticalmente il contenuto */
            align-items: center; /* Centra orizzontalmente il contenuto */
            height: 100vh; /* Il body occupa l'intera altezza della viewport */
            margin: 0;
            padding: 20px; /* Padding generale per evitare che il contenuto tocchi i bordi su schermi piccoli */
            touch-action: manipulation; /* Migliora la reattività al tocco su touchscreens */
            overflow: hidden; /* Previene scrollbar indesiderate se il contenuto è più grande della viewport */
            position: relative; /* Necessario per posizionare il pulsante shuffle in modo assoluto */
        }

        /* Stili del contenitore principale del player */
        .player-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem; /* Spazio tra gli elementi interni, leggermente più ampio per bilanciare il nuovo layout */
            padding: 20px;
            border-radius: 0; /* Bordi squadrati per l'estetica minimalista */
            background-color: black; /* Nessuno sfondo aggiuntivo */
            box-shadow: none; /* Nessuna ombra, come richiesto */
            max-width: 90%; /* Limita la larghezza massima a 90% dello schermo (utile su schermi molto larghi) */
            width: 400px; /* Larghezza predefinita per desktop */
        }

        /* Nuovo wrapper per il contenitore del pianeta (senza il pulsante random) */
        .top-section-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* gap: 1rem; Rimosso, non più necessario qui */
            margin-bottom: 1.5rem; /* Spazio sotto questo blocco */
        }

        /* Stili del pulsante Shuffle (nuovo nome per "Random") - Posizionato in alto */
        .shuffle-button {
            all: unset; /* Rimuove stili predefiniti */
            cursor: pointer;
            color: white; /* Colore dell'icona bianco */
            /* Dimensioni iniziali come le frecce (desktop) */
            width: 40px; 
            height: 40px; 
            font-size: 1.8rem; 
            padding: 0; /* Nessun padding extra per l'icona */
            border: 1px solid transparent; /* Bordo trasparente di default */
            border-radius: 50%; /* Rende il bottone circolare */
            transition: background-color 0.2s ease, border-color 0.2s ease, transform 0.1s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;

            /* Posizionamento assoluto in alto e centrato */
            position: absolute;
            top: 50px; /* 50px dal bordo superiore */
            left: 50%;
            transform: translateX(-50%);
            z-index: 20; /* Assicura che sia sopra gli altri elementi */
        }

        .shuffle-button:hover {
            transform: translateX(-50%) scale(1.1); /* Lieve ingrandimento all'hover e mantiene centrato */
            background-color: rgba(255, 255, 255, 0.1); /* Sfondo molto leggero all'hover */
        }

        .shuffle-button.active {
            border: 1px solid white; /* Bordo bianco quando attivo */
            background-color: transparent; /* MODIFICATO: Nessuno sfondo quando attivo */
        }

        .shuffle-button.active:hover {
            background-color: rgba(255, 255, 255, 0.2); /* MODIFICATO: Sfondo sull'hover SOLO quando attivo su desktop */
            border-color: white; /* Mantiene il bordo bianco */
        }

        /* Stili del contenitore dell'immagine del pianeta */
        .planet-image-container {
            position: relative; /* Aggiunto per il posizionamento assoluto del cerchio */
            width: 350px; /* Aumentato ulteriormente per desktop */
            height: 350px; /* Aumentato ulteriormente per desktop */
            border-radius: 50%; /* Rende l'immagine circolare */
            overflow: hidden; /* Nasconde ciò che eccede la forma circolare */
            display: flex; /* Per centrare l'immagine all'interno del contenitore */
            justify-content: center;
            align-items: center;
            transition: transform 0.1s ease-out; /* Transizione per un effetto più morbido all'avvio/fermata animazione */
            
            /* Applica l'animazione di rotazione qui, inizialmente in pausa */
            animation: rotate360 20s linear infinite;
            animation-play-state: paused;

            /* Nuovo: Sfondo blu come placeholder */
            background: radial-gradient(circle at center, #00008B 0%, #00005C 100%); /* Sfumatura di blu scuro */
        }

        /* Stili del cerchio nero centrale (foro del CD) */
        .cd-hole {
            position: absolute;
            width: 25px; /* Dimensione del foro */
            height: 25px; /* Dimensione del foro */
            background-color: black; /* Colore nero */
            border-radius: 50%; /* Rende il div un cerchio */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Centra il cerchio perfettamente */
            z-index: 10; /* Assicura che sia sopra l'immagine */
        }

        /* Nuovo stile per il cerchio con bordo */
        .cd-ring {
            position: absolute;
            width: 75px; /* Modificato a 75px */
            height: 75px; /* Modificato a 75px */
            background: none; /* Nessuno sfondo */
            border: 2px solid black; /* Bordo di 2px nero */
            border-radius: 50%; /* Rende il div un cerchio */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); /* Centra il cerchio perfettamente */
            z-index: 11; /* Assicura che sia sopra l'immagine e il cd-hole */
        }

        /* Stili dell'immagine del pianeta */
        #planetImage {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Assicura che l'immagine copra completamente il contenitore, adattandosi */
            display: block; /* Rimuove lo spazio extra sotto l'immagine */
        }

        /* Animazione di rotazione per l'immagine del pianeta */
        @keyframes rotate360 {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Contenitore per i bottoni di controllo (precedente, play/pausa, successivo) */
        .controls-wrapper {
            display: flex;
            align-items: center;
            gap: 1.2rem; /* Spazio tra i bottoni di controllo, in unità relative */
        }

        /* Stile base per tutti i bottoni del player */
        button {
            all: unset; /* Rimuove tutti gli stili predefiniti del bottone */
            display: flex;
            justify-content: center;
            align-items: center;
            background: none; /* Sfondo trasparente */
            cursor: pointer;
            transition: transform 0.1s ease-out; /* Transizione rapida per un feedback reattivo */
            position: relative;
            overflow: hidden;
        }

        /* Rimuovi l'effetto ripple per mantenere il minimalismo */
        button:active::before {
            content: none;
        }

        /* Stili del bottone Play/Pausa */
        .play-pause-button {
            width: 80px; /* Invariato */
            height: 80px; /* Invariato */
            border-radius: 50%; /* Circolare */
            border: 1px solid white; /* Bordo bianco sottile */
            background: none; /* Sfondo trasparente */
            box-shadow: none; /* Nessuna ombra */
        }

        .play-pause-button:hover {
            transform: scale(1.05); /* Lieve ingrandimento all'hover */
            background-color: rgba(255, 255, 255, 0.1); /* Sfondo molto leggero all'hover */
            box-shadow: none; /* Nessuna ombra */
        }

        .play-pause-button svg {
            width: 40px; /* Invariato */
            height: 40px; /* Invariato */
            fill: white; /* Colore dell'icona bianco */
        }

        .play-pause-button:disabled {
            opacity: 0.4; /* Rende il bottone disabilitato meno visibile */
            cursor: not-allowed;
            border-color: gray;
            background: none;
            box-shadow: none;
        }

        .play-pause-button:disabled svg {
            fill: gray;
        }

        /* Stili dei bottoni di navigazione (Precedente/Successivo) */
        .nav-button {
            width: 40px; /* Invariato */
            height: 40px; /* Invariato */
            border-radius: 50%; /* Circolare */
            color: white; /* Colore delle icone bianco */
            font-size: 1.8rem; /* Invariato */
            background: none; /* Sfondo trasparente */
            box-shadow: none; /* Nessuna ombra */
            border: 1px solid transparent; /* Bordo trasparente di default */
        }

        .nav-button:hover {
            transform: scale(1.1); /* Ingrandimento all'hover */
            background-color: rgba(255, 255, 255, 0.1); /* Sfondo leggero all'hover */
            color: white;
            box-shadow: none; /* Nessuna ombra */
            border-color: white; /* Bordo bianco all'hover */
        }

        /* Stili per il testo "traccia_00N" */
        .track-info-text {
            font-size: 1.2rem;
            text-transform: lowercase; /* Assicura che il testo sia sempre in minuscolo */
            color: white;
            margin-top: 1.5rem; /* Spazio sopra il testo (tra controlli e testo) */
            margin-bottom: 0; /* Nessun margine inferiore, gestito dal gap del container */
            letter-spacing: 0.05em; /* Spaziatura tra le lettere */
            font-weight: 400; /* Peso del font normale */
            text-align: center;
        }

        /* Media queries per la responsività su schermi medi (es. tablet in verticale) */
        @media (max-width: 768px) {
            .player-container {
                padding: 20px;
                gap: 1.5rem;
                width: 350px;
            }

            .planet-image-container {
                width: 380px; /* Aumentato per schermi medi per mantenerlo molto più grande */
                height: 380px; /* Aumentato per schermi medi per mantenerlo molto più grande */
                /* Rimosso margin-bottom, ora gestito da top-section-wrapper */
            }

            .shuffle-button {
                width: 35px; /* Adattato per schermi medi */
                height: 35px; /* Adattato per schermi medi */
                font-size: 1.6rem; /* Adattato per schermi medi */
                top: 30px; /* Leggermente più in alto su tablet */
            }

            /* Rimosso: .shuffle-button:hover qui per evitare override indesiderati */
            /* Invece si gestisce con la regola generale per i dispositivi touch */
            .shuffle-button.active:hover {
                 /* Su mobile, l'hover sull'active non deve avere sfondo, ma il bordo deve rimanere */
                 background-color: transparent; /* MODIFICATO */
                 border-color: white; /* Mantiene il bordo bianco */
                 transform: translateX(-50%) scale(1); /* MODIFICATO: Reset dell'ingrandimento e mantiene centrato */
            }


            .play-pause-button {
                width: 70px; /* Invariato */
                height: 70px; /* Invariato */
            }

            .play-pause-button svg {
                width: 35px; /* Invariato */
                height: 35px; /* Invariato */
            }

            .nav-button {
                width: 35px; /* Invariato */
                height: 35px; /* Invariato */
                font-size: 1.6rem; /* Invariato */
            }

            /* Rimuove gli effetti hover su tutti i bottoni sui dispositivi touch */
            button:hover { /* REGOLA GENERALE PER I BOTTONI */
                transform: scale(1); /* Reset dell'ingrandimento all'hover */
                background-color: transparent; /* Reset dello sfondo all'hover */
                box-shadow: none; /* Reset dell'ombra */
                border-color: transparent; /* Reset del bordo all'hover per nav-button */
            }
            .play-pause-button:hover { /* Specifico per play/pause se necessario */
                border-color: white; /* Assicura che il bordo di play/pause rimanga */
            }

            /* Garantisce che lo stato "active" non aggiunga bordi o sfondi persistenti */
            .play-pause-button:active {
                background-color: transparent;
                border-color: white; /* Mantiene il bordo bianco al click */
            }
            .nav-button:active {
                background-color: transparent;
                border-color: white; /* Mantiene il bordo bianco al click */
            }
            .shuffle-button:active { /* Aggiunto per il pulsante shuffle */
                background-color: transparent;
                border-color: white; /* Mantiene il bordo bianco al click se attivo */
            }
        }

        /* Media queries per la responsività su schermi piccoli (es. smartphone) */
        @media (max-width: 480px) {
            .player-container {
                padding: 15px;
                gap: 1.2rem;
                width: 95%; /* Leggermente aumentato la larghezza massima per sfruttare lo spazio */
            }

            .planet-image-container {
                width: 320px; /* Aumentato per schermi piccoli per mantenerlo molto più grande */
                height: 320px; /* Aumentato per schermi piccoli per mantenerlo molto più grande */
                /* Rimosso margin-bottom, ora gestito da top-section-wrapper */
            }

            .shuffle-button {
                width: 30px; /* Adattato per schermi piccoli */
                height: 30px; /* Adattato per schermi piccoli */
                font-size: 1.4rem; /* Adattato per schermi piccoli */
                top: 20px; /* Leggermente più in alto su smartphone */
            }

            /* Rimosso: .shuffle-button:hover qui per evitare override indesiderati */
            /* Invece si gestisce con la regola generale per i dispositivi touch */
            .shuffle-button.active:hover {
                 /* Su mobile, l'hover sull'active non deve avere sfondo, ma il bordo deve rimanere */
                 background-color: transparent; /* MODIFICATO */
                 border-color: white; /* Mantiene il bordo bianco */
                 transform: translateX(-50%) scale(1); /* MODIFICATO: Reset dell'ingrandimento e mantiene centrato */
            }

            .play-pause-button {
                width: 60px; /* Invariato */
                height: 60px; /* Invariato */
            }

            .play-pause-button svg {
                width: 30px; /* Invariato */
                height: 30px; /* Invariato */
            }

            .nav-button {
                width: 30px; /* Invariato */
                height: 30px; /* Invariato */
                font-size: 1.4rem; /* Invariato */
            }

            /* Rimuove gli effetti hover su tutti i bottoni sui dispositivi touch */
            button:hover { /* REGOLA GENERALE PER I BOTTONI */
                transform: scale(1); /* Reset dell'ingrandimento all'hover */
                background-color: transparent; /* Reset dello sfondo all'hover */
                box-shadow: none; /* Reset dell'ombra */
                border-color: transparent; /* Reset del bordo all'hover per nav-button */
            }
            .play-pause-button:hover { /* Specifico per play/pause se necessario */
                border-color: white; /* Assicura che il bordo di play/pause rimanga */
            }

            /* Garantisce che lo stato "active" non aggiunga bordi o sfondi persistenti */
            .play-pause-button:active {
                background-color: transparent;
                border-color: white; /* Mantiene il bordo bianco al click */
            }
            .nav-button:active {
                background-color: transparent;
                border-color: white; /* Mantiene il bordo bianco al click */
            }
            .shuffle-button:active { /* Aggiunto per il pulsante shuffle */
                background-color: transparent;
                border-color: white; /* Mantiene il bordo bianco al click se attivo */
            }
        }
    </style>
</head>
<body>

    <!-- Pulsante Random (shuffle) posizionato in alto sulla pagina -->
    <button id="randomBtn" class="shuffle-button">
        <span class="material-symbols-outlined">shuffle</span>
    </button>

    <!-- Contenitore principale del player audio -->
    <div class="player-container">
        <!-- Wrapper per il contenitore del pianeta (senza il pulsante random, che è stato spostato) -->
        <div class="top-section-wrapper">
            <!-- Contenitore per l'immagine circolare del pianeta -->
            <div class="planet-image-container">
                <!-- L'attributo src verrà impostato dinamicamente dal JavaScript -->
                <img src="" alt="" id="planetImage">
                <!-- Nuovo elemento: il cerchio nero centrale -->
                <div class="cd-hole"></div>
                <!-- Nuovo elemento: il cerchio con bordo -->
                <div class="cd-ring"></div>
            </div>
        </div>

        <!-- Wrapper per i controlli di navigazione e riproduzione -->
        <div class="controls-wrapper">
            <!-- Bottone per tornare alla traccia precedente -->
            <button id="prevBtn" class="nav-button">
                <span class="material-symbols-outlined">skip_previous</span>
            </button>

            <!-- Centrale Play/Pausa button -->
            <button id="toggleBtn" class="play-pause-button">
                <!-- SVG icon that switches between play and pause -->
                <svg id="icon" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/> <!-- Initial play icon -->
                </svg>
            </button>

            <!-- Bottone per passare alla traccia successiva -->
            <button id="nextBtn" class="nav-button">
                <span class="material-symbols-outlined">skip_next</span>
            </button>
        </div>

        <!-- Testo che mostra il numero della traccia corrente (spostato sotto i controlli) -->
        <p id="trackNumberDisplay" class="track-info-text"></p>

        <!-- Elemento audio HTML5 -->
        <audio id="myAudio" loop>
            <!-- Le sorgenti audio verranno caricate dinamicamente da JavaScript -->
            Il tuo browser non supporta l'audio.
        </audio>
    </div>

    <script>
        // References to DOM elements
        const audio = document.getElementById('myAudio');
        const toggleBtn = document.getElementById('toggleBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const icon = document.getElementById('icon');
        const trackNumberDisplay = document.getElementById('trackNumberDisplay');
        const planetImageContainer = document.querySelector('.planet-image-container');
        const planetImage = document.getElementById('planetImage');
        const randomBtn = document.getElementById('randomBtn'); // Riferimento al nuovo pulsante random

        // Array delle tracce audio, con titolo e percorso del file
        const tracks = [
            { title: 'traccia_001', src: 'assets/audio/tr-001.wav', planetImage: 'assets/images/plnt-001.jpg' },
            { title: 'traccia_002', src: 'assets/audio/tr-002.wav', planetImage: 'assets/images/plnt-002.jpg' },
            { title: 'traccia_003', src: 'assets/audio/tr-003.wav', planetImage: 'assets/images/plnt-003.jpg' },
            { title: 'traccia_004', src: 'assets/audio/tr-004.wav', planetImage: 'assets/images/plnt-004.jpg' },
            { title: 'traccia_005', src: 'assets/audio/tr-005.wav', planetImage: 'assets/images/plnt-005.jpg' },
            { title: 'traccia_006', src: 'assets/audio/tr-006.wav', planetImage: 'assets/images/plnt-006.jpg' },
            { title: 'traccia_007', src: 'assets/audio/tr-007.wav', planetImage: 'assets/images/plnt-007.jpg' },
            { title: 'traccia_008', src: 'assets/audio/tr-008.wav', planetImage: 'assets/images/plnt-008.jpg' },
            { title: 'traccia_009', src: 'assets/audio/tr-009.wav', planetImage: 'assets/images/plnt-009.jpg' }
        ];

        let currentTrackIndex = 0; // Indice della traccia attualmente in riproduzione
        let isRandomMode = false; // Stato della modalità casuale

        // Icone SVG per i stati Play e Pausa
        const playIcon = `<path d="M8 5v14l11-7z"/>`;
        const pauseIcon = `<path d="M6 19h4V5H6zm8-14v14h4V5h-4z"/>`;

        /**
         * Genera un indice di traccia casuale che non sia quello corrente (se possibile).
         * @returns {number} L'indice della traccia casuale.
         */
        function getRandomTrackIndex() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * tracks.length);
            } while (newIndex === currentTrackIndex && tracks.length > 1); // Assicura una traccia diversa se ce ne sono più di una
            return newIndex;
        }

        /**
         * Carica una traccia audio specificata dall'indice nell'array `tracks`.
         * Aggiorna il testo della traccia, l'immagine del pianeta e gestisce lo stato dei bottoni di navigazione.
         * @param {number} index L'indice della traccia da caricare.
         * @param {boolean} shouldPlayAfterLoad Se true, la traccia verrà riprodotta automaticamente dopo il caricamento.
         */
        function loadTrack(index, shouldPlayAfterLoad = false) {
            // Se l'audio era in riproduzione, lo metto in pausa prima di cambiare traccia
            if (!audio.paused) {
                audio.pause();
            }
            icon.innerHTML = playIcon; // Reimposto l'icona su Play
            planetImageContainer.style.animationPlayState = 'paused'; // Metti in pausa la rotazione

            currentTrackIndex = index; // Aggiorno l'indice della traccia corrente
            audio.src = tracks[currentTrackIndex].src; // Imposto la sorgente del file audio
            planetImage.src = tracks[currentTrackIndex].planetImage; // Nuovo: Imposto l'immagine del pianeta

            // --- DEBUG: Log dei percorsi che il browser cerca di caricare ---
            console.log("Tentativo di caricare audio da:", audio.src);
            console.log("Tentativo di caricare immagine da:", planetImage.src);
            // --- FINE DEBUG ---

            // Aggiorno il testo con il formato "traccia_00N", assicurando minuscolo
            trackNumberDisplay.textContent = `traccia_00${currentTrackIndex + 1}`;
            audio.load(); // Carica la nuova sorgente audio

            // Event listener per gestire errori di caricamento del media (es. file non trovato)
            audio.onerror = (e) => {
                console.error("Errore di caricamento audio per la traccia:", tracks[currentTrackIndex].title, e);
                trackNumberDisplay.textContent = `Errore: "${tracks[currentTrackIndex].title}" non trovata o non supportata.`;
                toggleBtn.disabled = true; // Disabilita il pulsante Play/Pausa se c'è un errore
                icon.innerHTML = playIcon; // Assicurati che l'icona sia Play
                planetImageContainer.style.animationPlayState = 'paused'; // Ferma animazione
            };

            // Event listener per quando i metadati sono caricati (e il file è disponibile)
            audio.onloadedmetadata = () => {
                toggleBtn.disabled = false; // Abilita il pulsante Play/Pausa solo quando la traccia è caricata
            };

            // Se richiesto, riproduci la traccia dopo il caricamento
            if (shouldPlayAfterLoad) {
                audio.play()
                    .then(() => {
                        // Aggiorna l'interfaccia solo se la riproduzione è avvenuta con successo
                        icon.innerHTML = pauseIcon;
                        planetImageContainer.style.animationPlayState = 'running';
                    })
                    .catch(error => {
                        console.error("Errore durante l'avvio della riproduzione (potrebbe essere dovuto a policy browser o sorgente):", error);
                        // Assicurati che l'interfaccia rifletta lo stato di pausa se l'avvio fallisce
                        icon.innerHTML = playIcon;
                        planetImageContainer.style.animationPlayState = 'paused';
                        // Non disabilitare il pulsante qui, l'utente dovrebbe poter riprovare manualmente
                        // se l'errore è un "NotAllowedError" (autoplay bloccato).
                    });
            } else {
                // Se non deve riprodurre automaticamente, assicurati che il pulsante sia abilitato
                // una volta che i metadati sono caricati. Questo è ora gestito da audio.onloadedmetadata
            }
        }

        // Event listener per il bottone Play/Pausa
        toggleBtn.addEventListener('click', () => {
            if (audio.paused) {
                audio.play()
                    .then(() => {
                        icon.innerHTML = pauseIcon;
                        planetImageContainer.style.animationPlayState = 'running';
                    })
                    .catch(error => {
                        console.error("Errore durante l'avvio della riproduzione:", error);
                        icon.innerHTML = playIcon;
                        planetImageContainer.style.animationPlayState = 'paused';
                    });
            } else {
                audio.pause();
                icon.innerHTML = playIcon;
                planetImageContainer.style.animationPlayState = 'paused';
            }
        });

        // Event listener per il bottone 'Precedente'
        prevBtn.addEventListener('click', () => {
            let newIndex;
            if (isRandomMode) {
                newIndex = getRandomTrackIndex();
            } else {
                newIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
            }
            loadTrack(newIndex, false); 
        });

        // Event listener per il bottone 'Successivo'
        nextBtn.addEventListener('click', () => {
            let newIndex;
            if (isRandomMode) {
                newIndex = getRandomTrackIndex();
            } else {
                newIndex = (currentTrackIndex + 1) % tracks.length;
            }
            loadTrack(newIndex, false); 
        });

        // Event listener: quando una traccia finisce (loop continuo o random)
        audio.addEventListener('ended', () => {
            let nextIndex;
            if (isRandomMode) {
                nextIndex = getRandomTrackIndex();
            } else {
                nextIndex = (currentTrackIndex + 1) % tracks.length; 
            }
            loadTrack(nextIndex, true); 
        });

        // Event listener per il pulsante 'Random'
        randomBtn.addEventListener('click', () => {
            isRandomMode = !isRandomMode; // Inverti lo stato
            randomBtn.classList.toggle('active', isRandomMode); // Aggiorna la classe per lo stile
        });

        // Inizializza il player con la prima traccia al caricamento della pagina
        document.addEventListener('DOMContentLoaded', () => {
            loadTrack(currentTrackIndex, false); 
        });
    </script>
</body>
</html>
